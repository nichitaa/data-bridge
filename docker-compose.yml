version: "3"

services:
  # Phoenix Gateway (WS API - Channels & REST API)
  phoenix_gateway:
    container_name: phoenix_gateway
    build:
      context: ./gateway
      dockerfile: Dockerfile
    ports:
      - "9999:9999"
    environment:
      # will load config from `gateway/config/prod.exs`
      MIX_ENV: prod

  # Client Application
  react_client:
    container_name: react_client
    build:
      context: ./client
      dockerfile: Dockerfile
    ports:
      - '3000:3000'
    depends_on:
      - phoenix_gateway
  connectore-service:
    image: nicolaedockerid/connectorservice
    ports:
      - 8081:80
  auth-service:
    image: nicolaedockerid/authservice
    ports:
      - 8080:80
  ms-sql-server:
    image: mcr.microsoft.com/mssql/server:2017-latest-ubuntu
    environment:
      ACCEPT_EULA: "Y"
      SA_PASSWORD: "aDMIN123*"
      MSSQL_PID: EXPRESS
    ports:
      - 1433:1433